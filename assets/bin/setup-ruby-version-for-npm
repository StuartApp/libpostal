#!/bin/bash

INSTALLED_RUBY_VERSION=$(ruby --version | head -c8 | awk '{print $2}')
test -z ${FPM_REQUIRED_RUBY_VERSION+x} && FPM_REQUIRED_RUBY_VERSION=2.3

dpkg --compare-versions ${INSTALLED_RUBY_VERSION} ge ${FPM_REQUIRED_RUBY_VERSION}
if [ $? -ne 0 ]
then
  command curl -sSL https://rvm.io/mpapis.asc | gpg --import -
  command curl -sSL https://rvm.io/pkuczynski.asc | gpg --import -
  curl -sSL https://get.rvm.io | bash -s stable
  source /etc/profile.d/rvm.sh
  rvm install ${FPM_REQUIRED_RUBY_VERSION}
fi
